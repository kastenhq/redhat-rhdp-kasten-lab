<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kasten Multi-Cluster :: Backup/DR/Mobility with Veeam Kasten</title>
    <link rel="prev" href="module01-lab03-backup-restore.html">
    <link rel="next" href="module01-lab05-mobility.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://demo.redhat.com" target="_blank" style="margin-left: 5%;">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1008.5 178.739" style="width: 200px;"><g fill="#fff"><path d="M316.6 63.2v-56H342a21.279 21.279 0 0 1 7.8 1.3 18.111 18.111 0 0 1 5.9 3.5 15.577 15.577 0 0 1 5 11.8 15.051 15.051 0 0 1-3.1 9.5 16.836 16.836 0 0 1-8.4 5.8l12.5 24.1h-9.3l-11.6-23H325v23Zm24.7-48.6H325v18.7h16.3q5.25 0 8.1-2.7a8.7 8.7 0 0 0 2.8-6.6 8.7 8.7 0 0 0-2.8-6.6c-1.8-1.9-4.5-2.8-8.1-2.8ZM364.1 42.8a20.674 20.674 0 0 1 1.6-8.2 20.288 20.288 0 0 1 4.3-6.7 19.92 19.92 0 0 1 6.5-4.5 19.718 19.718 0 0 1 8-1.6 18.463 18.463 0 0 1 7.8 1.6 18.677 18.677 0 0 1 6.2 4.5 20.927 20.927 0 0 1 4.1 6.8 23.2 23.2 0 0 1 1.5 8.4v2.3H372a13.822 13.822 0 0 0 4.6 8.4 13.6 13.6 0 0 0 9.1 3.3 15.553 15.553 0 0 0 5.7-1 12.858 12.858 0 0 0 4.6-2.6l5.1 5a25.983 25.983 0 0 1-7.4 4.1 24.69 24.69 0 0 1-8.4 1.3 21.306 21.306 0 0 1-8.4-1.6 22.763 22.763 0 0 1-6.8-4.4 20.788 20.788 0 0 1-4.5-6.7 23.2 23.2 0 0 1-1.5-8.4Zm20.2-14.2a11.527 11.527 0 0 0-8 3 13.046 13.046 0 0 0-4.2 7.8h24.2a13.091 13.091 0 0 0-4.2-7.8 11.106 11.106 0 0 0-7.8-3ZM443.1 63.2v-3.8a19.448 19.448 0 0 1-5.8 3.3 18.924 18.924 0 0 1-6.7 1.2 19.824 19.824 0 0 1-14.6-6.1 22.268 22.268 0 0 1-4.4-6.7 21.812 21.812 0 0 1 0-16.4A20.534 20.534 0 0 1 416 28a19.335 19.335 0 0 1 6.6-4.5 20.334 20.334 0 0 1 8.2-1.6 20.7 20.7 0 0 1 6.6 1 19.415 19.415 0 0 1 5.7 3V7.2l8-1.8v57.8Zm-25.2-20.4a13.718 13.718 0 0 0 4 10.1 13.45 13.45 0 0 0 9.8 4.1 14.956 14.956 0 0 0 6.4-1.3 15.954 15.954 0 0 0 4.9-3.6V33.6a14.988 14.988 0 0 0-4.9-3.5 15.271 15.271 0 0 0-6.4-1.3 13.423 13.423 0 0 0-9.9 4 13.806 13.806 0 0 0-3.9 10ZM478.1 63.2v-56h8.4v24h29.8v-24h8.4v56h-8.4V38.8h-29.8v24.4ZM547.2 64a16.483 16.483 0 0 1-10.8-3.5 11.037 11.037 0 0 1-4.2-8.9 10.375 10.375 0 0 1 4.7-9.2 20.76 20.76 0 0 1 11.8-3.2 27.841 27.841 0 0 1 5.8.6 27.374 27.374 0 0 1 5.3 1.6v-4.3a8.143 8.143 0 0 0-2.6-6.5 11.452 11.452 0 0 0-7.4-2.2 20.788 20.788 0 0 0-6 .9 34.616 34.616 0 0 0-6.6 2.6l-3-6a54.169 54.169 0 0 1 8.4-3.1 33.18 33.18 0 0 1 8.3-1.1c5.2 0 9.3 1.3 12.2 3.8s4.4 6.1 4.4 10.8v27h-7.8v-3.5a19.441 19.441 0 0 1-5.8 3.2 23.54 23.54 0 0 1-6.7 1Zm-7.3-12.6a5.646 5.646 0 0 0 2.6 4.8 11.193 11.193 0 0 0 6.6 1.8 16.256 16.256 0 0 0 5.9-1 14.449 14.449 0 0 0 4.9-2.9V47a19.778 19.778 0 0 0-4.8-1.8 24.933 24.933 0 0 0-5.7-.6 11.859 11.859 0 0 0-6.8 1.8 5.728 5.728 0 0 0-2.7 5ZM580.6 53.2v-24H572v-6.7h8.6V12.1l7.9-1.9v12.3h12v6.7h-12v22.1a5.94 5.94 0 0 0 1.4 4.4c.9.9 2.5 1.3 4.6 1.3a23.637 23.637 0 0 0 3-.2 10.857 10.857 0 0 0 2.8-.8v6.7a19.28 19.28 0 0 1-3.8.9 27.484 27.484 0 0 1-3.8.3c-3.9 0-7-.9-9-2.8-2-1.7-3.1-4.4-3.1-7.9Z"></path></g><path d="M127 90.2c12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4L149.8 37c-1.7-7.1-3.2-10.3-15.7-16.6-9.7-5-30.8-13.1-37.1-13.1-5.8 0-7.5 7.5-14.4 7.5-6.7 0-11.6-5.6-17.9-5.6-6 0-9.9 4.1-12.9 12.5 0 0-8.4 23.7-9.5 27.2a4.216 4.216 0 0 0-.3 1.9c0 9.2 36.3 39.4 85 39.4Zm32.5-11.4c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3C21.8 58.8 0 61.8 0 81c0 31.5 74.6 70.3 133.7 70.3 45.3 0 56.7-20.5 56.7-36.6-.1-12.8-11-27.3-30.9-35.9Z" fill="#e00"></path><path d="M159.5 78.8c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3l3.7-9.1a4.877 4.877 0 0 0-.3 2c0 9.2 36.3 39.4 85 39.4 12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4Z"></path><path d="M253.5 158.7a2.22 2.22 0 0 1-2.2-2.2V2.2a2.2 2.2 0 0 1 4.4 0v154.2a2.242 2.242 0 0 1-2.2 2.3Z" fill="#fff"></path><text data-name="Demo Platform" transform="translate(1186 149)" fill="#e00" font-size="82" font-family="'RedHatDisplay', 'Overpass', overpass, helvetica, arial, sans-serif" font-weight="700"><tspan x="-877.892" y="0">One</tspan></text></svg>
      </a>
      <a class="navbar-item site-title" target="__blank" style="color: #fff !important;" href="..">Backup/DR/Mobility with Veeam Kasten</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item navbar-item-right-dropdown has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Links</a>
          <div class="navbar-dropdown navbar-dropdown-right">
            <a class="navbar-item navbar-item-right-content" href="https://redhat.com" target="_blank">Red Hat</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="modules" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Backup/DR/Mobility with Veeam Kasten</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction to Veeam Kasten</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="module01-intro.html">Module 1 - Protecting Virtual Machines on OpenShift with Veeam Kasten</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module01-lab01-install.html">Installing Veeam Kasten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module01-lab02-location-profile.html">Configuring Veeam Kasten for Backups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module01-lab03-backup-restore.html">Protecting Virtual Machines</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="module01-lab04-multicluster.html">Configuring Multi-Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module01-lab05-mobility.html">Migrating Workloads</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="module02-intro.html">Module 2 - Protecting Containerized Workloads with Veeam Kasten</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module02-lab01-pacman.html">Deploy a Sample Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module02-lab02-configure.html">Configure Kasten for Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module02-lab03-backup-recovery.html">Backup and Recover our Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="module02-lab04-blueprints.html">Provide Application Consistent Backups via Kasten Blueprints</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Backup/DR/Mobility with Veeam Kasten</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Backup/DR/Mobility with Veeam Kasten</a></li>
    <li><a href="module01-intro.html">Module 1 - Protecting Virtual Machines on OpenShift with Veeam Kasten</a></li>
    <li><a href="module01-lab04-multicluster.html">Configuring Multi-Cluster</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Kasten Multi-Cluster</h1>
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This section is for your information only. You can not execute this section on this lab environment because we are using a shared cluster for many users. Feel free to read through this section however to understand how you would set up Kasten for Multi-Cluster backup and restore.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The demo environment on the <a href="https://demo.redhat.com" target="_blank" rel="noopener">Red Hat Demo Platform</a> does not have that restriction. Feel free to use that environment after Red Hat One.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_introduction"><a class="anchor" href="#_1_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each Veeam Kasten deployment can function completely independent of other instances, without dependence on a separate customer-hosted or SaaS control plane - making it ideal for GitOps-style management and use in fully airgapped environments.
However, Kasten also provides a user interface for providing consolidated observability and centralized management of globally configured Kasten resources - <strong><em>Kasten Multi-cluster Manager</em></strong>.</p>
</div>
<hr>
<div class="paragraph">
<p><em>In this exercise you will configure Kasten Multi-cluster Manager, join a second cluster, and distribute a centrally managed location profile to both clusters.</em></p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
As each learner only has a single cluster, you will need to work with a partner, designating (1) user/cluster as <code>cluster-1</code> and (1) user/cluster as <code>cluster-2</code>.*
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_configuring_primary_cluster"><a class="anchor" href="#_2_configuring_primary_cluster"></a>2. Configuring Primary Cluster</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
This section should be completed by the <code>cluster-1</code> user <strong><em>ONLY</em></strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong><em>Primary</em></strong> cluster defines and stores all global resources, such as Policies and Profiles, and also <a href="https://docs.kasten.io/latest/operating/monitoring.html#k10-multi-cluster-metrics">aggregates a subset of cluster metrics</a> for centralized reporting.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong><em>Kasten Dashboard</em></strong>, select <strong><em>Multi-Cluster</em></strong> from the sidebar.</p>
</li>
<li>
<p>Under <strong><em>Promote to Primary</em></strong>, click <strong><em>Setup</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/02.png" alt="02">
</div>
</div>
</li>
<li>
<p>Specify <code>cluster-1</code> as the <strong><em>Primary Name</em></strong> and click <strong><em>Promote Cluster → Confirm</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/03.png" alt="03">
</div>
</div>
<div class="paragraph">
<p>After setup completes, you should see the <strong><em>Multi-cluster Manager</em></strong> view.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/04.png" alt="04">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A Kasten cluster can also be promoted to the primary cluster role declaratively using Helm/Operand parameters.
See <a href="https://docs.kasten.io/latest/multicluster/tutorials/getting_started.html#setting-up-the-primary-cluster-using-helm">docs.kasten.io</a> for details.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Select <strong><em>Join Tokens</em></strong> from the sidebar and click <strong><em>+ Create New Join Token</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/05.png" alt="05">
</div>
</div>
</li>
<li>
<p>Specify <code>lab-token</code> as the <strong><em>Name</em></strong> and click <strong><em>Confirm</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/06.png" alt="06">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Join Tokens are a type of Kubernetes Secret that can be created declaratively.
See <a href="https://docs.kasten.io/latest/multicluster/tutorials/getting_started.html#join-tokens">docs.kasten.io</a> for examples.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A single token can be used for multiple clusters.
Deleting tokens has no impact on clusters that have already joined multi-cluster, but will prevent additional clusters from joining using the deleted token.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong><em>Copy</em></strong> to copy the token value to the clipboard and send the value to your <code>cluster-2</code> partner via one of the following:</p>
<div class="ulist">
<ul>
<li>
<p>Email/Slack/etc.</p>
</li>
<li>
<p>Slowly reading it aloud 😡</p>
</li>
<li>
<p>Carrier pigeon 🪶</p>
</li>
<li>
<p>Writing it down on a Post-It and burning it after use 🤷‍♂️</p>
</li>
<li>
<p>Probably stick with Email/Slack/etc. 👍</p>
</li>
<li>
<p>In real life, token values could be distributed to clusters using any Kubernetes Secrets management solution (ex.
Vault + External Secrets Operator)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong><em>Done</em></strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_joining_multi_cluster_from_secondary"><a class="anchor" href="#_3_joining_multi_cluster_from_secondary"></a>3. Joining Multi-Cluster from Secondary</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
This section should be completed by the <code>cluster-2</code> user <strong><em>ONLY</em></strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong><em>Kasten Dashboard</em></strong>, select <strong><em>Multi-Cluster</em></strong> from the sidebar.</p>
</li>
<li>
<p>Under <strong><em>Join a Multi-Cluster System</em></strong>, click <strong><em>Join</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/07.png" alt="07">
</div>
</div>
</li>
<li>
<p>Paste the <code>lab-token</code> value from the primary cluster into the <strong><em>Token</em></strong> field.</p>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The join token also encodes the Kasten ingress URL required for a secondary to reach the primary cluster.
If an alternate URL is required in a production environment, this value can be overridden as seen in the UI.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Specify <code>cluster-2</code> as the <strong><em>Local Cluster Name</em></strong> and click <strong><em>Use Current</em></strong> to populate <strong><em>Local Cluster Ingress</em></strong> with the current Kasten Route value.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/08.png" alt="08">
</div>
</div>
</li>
<li>
<p>Click <strong><em>Connect → Yes</em></strong> to join <code>cluster-2</code>.</p>
<div class="paragraph">
<p>After a few moments you should observe the Multi-Cluster status page indicating the cluster has been connected to <code>cluster-1</code> as a primary.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/09.png" alt="09">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Joining secondary clusters can also be automated as part of a GitOps-style deployment by creating a <code>mc-join</code> Secret and <code>mc-join-config</code> ConfigMap on the secondary cluster to provide the join token and name/ingress details.
See <a href="https://docs.kasten.io/latest/multicluster/tutorials/getting_started.html#adding-a-secondary-cluster">docs.kasten.io</a> for details.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_managing_global_resources"><a class="anchor" href="#_4_managing_global_resources"></a>4. Managing Global Resources</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
This section should be completed by the <code>cluster-1</code> user <strong><em>ONLY</em></strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>cluster-1</code> <strong><em>Kasten Dashboard</em></strong>, select <strong><em>Multi-Cluster Manager</em></strong> from the dropdown menu and validate the <strong><em>Clusters</em></strong> page now displays both clusters.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/10.png" alt="10">
</div>
</div>
</li>
<li>
<p>Click the <strong><em>Grant Permissions</em></strong> button to configure permissions for the current <strong><em>Kasten Dashboard</em></strong> user.</p>
<div class="paragraph">
<p>This will pre-fill a form to extend the <code>k10-multi-cluster-admin</code> ClusterRole to the current user for all current and future Kasten clusters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/11.png" alt="11">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a production environment this can be modified to give granular control over a subset of clusters to different users or groups.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Keep the default settings and click <strong><em>Save</em></strong>.</p>
</li>
<li>
<p>Select <strong><em>Clusters</em></strong> from the sidebar and click into <code>cluster-2</code> to validate it is accessible.
The sidebar dropdown menu can be used to browse between available clusters and the <strong><em>Multi-Cluster Manager</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/12.png" alt="12">
</div>
</div>
</li>
<li>
<p>In <strong><em>Kasten Multi-Cluster Manager</em></strong>, select <strong><em>Global Profiles → Location</em></strong> from the sidebar and click <strong><em>+ New Profile</em></strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/13.png" alt="13">
</div>
</div>
</li>
<li>
<p>Fill out the following fields and click <strong><em>Next</em></strong>:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Profile Name</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>global-profile-example</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Storage Provider</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 Compatible</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>In the <strong><em>Web Terminal</em></strong>, run the following to fetch your existing Ceph Object Gateway bucket details:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> export CEPH_S3_ENDPOINT="https://$(oc get route \
   s3 -n openshift-storage -o jsonpath='{.spec.host}')"
 export AWS_ACCESS_KEY_ID=$(oc get secret \
   rook-ceph-object-user-ocs-storagecluster-cephobjectstore-ocs-storagecluster-cephobjectstoreuser \
   -n openshift-storage -o jsonpath='{.data.AccessKey}' | base64 --decode)
 export AWS_SECRET_ACCESS_KEY=$(oc get secret \
   rook-ceph-object-user-ocs-storagecluster-cephobjectstore-ocs-storagecluster-cephobjectstoreuser \
   -n openshift-storage -o jsonpath='{.data.SecretKey}' | base64 --decode)

 printf '%s\n' 'ACCESS KEY:' ${AWS_ACCESS_KEY_ID} 'SECRET KEY:' ${AWS_SECRET_ACCESS_KEY} 'ENDPOINT:' ${CEPH_S3_ENDPOINT}</code></pre>
</div>
</div>
</li>
<li>
<p>Return to the <strong><em>Kasten Multi-Cluster Manager</em></strong> and fill out the following fields:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>S3 Access Key</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paste <code>ACCESS KEY</code> value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>S3 Secret</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paste <code>SECRET KEY</code> value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Endpoint</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paste <code>ENDPOINT</code> value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Region</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>us-east-1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Bucket</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kasten</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/14.png" alt="14">
</div>
</div>
</li>
<li>
<p>Click <strong><em>Next → Submit</em></strong>.</p>
</li>
<li>
<p>Select <strong><em>Distributions</em></strong> from the sidebar and click <strong><em>+ New Distribution</em></strong>.</p>
<div class="paragraph">
<p>Distributions define which global resources should be synced with which clusters, allowing administrators to define label-based rules to automate resource distribution for new Kasten installs joining multi-cluster.</p>
</div>
</li>
<li>
<p>Fill out the following fields:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Name</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example-distribution</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Clusters</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select <code>dist.kio.kasten.io/cluster-type:primary</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select <code>dist.kio.kasten.io/cluster-type:secondary</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>Resources</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select <code>global-profile-example</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/15.png" alt="15">
</div>
</div>
<div class="paragraph">
<p>This configuration will ensure the <code>global-profile-example</code> Location Profile is synced to all current and future Kasten clusters.</p>
</div>
</li>
<li>
<p>Click <strong><em>Add Distribution</em></strong>.</p>
<div class="paragraph">
<p>You should observe that the distribution has been synced to the selected clusters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/16.png" alt="16">
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can view a summary of global resources for each cluster from the <strong><em>Multi-Cluster</em></strong> status page as shown below.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/module01-lab04-multicluster/17.png" alt="17">
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_takeaways"><a class="anchor" href="#_5_takeaways"></a>5. Takeaways</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Kasten Multi-Cluster Manager provides an interface for administrators to manage many Kasten deployments from a single interface</p>
</li>
<li>
<p>Kasten policies and profiles can be centrally defined to simplify change management and ensure consistency across large environments</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="module01-lab03-backup-restore.html" class="query-params-link">Protecting Virtual Machines</a></span>
  <span class="next"><a href="module01-lab05-mobility.html" class="query-params-link">Migrating Workloads</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>  </div>
</main>
</div>
<footer class="footer">
  <a href="https://demo.redhat.com" target="_blank" class="poweredBy"><p>Powered by</p><div class="labInfo_poweredBy" style="display: block; width: 260px;"><svg class="labInfo_poweredByLogo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1508.5 178.739"><g fill="#111"><path d="M316.6 63.2v-56H342a21.279 21.279 0 0 1 7.8 1.3 18.111 18.111 0 0 1 5.9 3.5 15.577 15.577 0 0 1 5 11.8 15.051 15.051 0 0 1-3.1 9.5 16.836 16.836 0 0 1-8.4 5.8l12.5 24.1h-9.3l-11.6-23H325v23Zm24.7-48.6H325v18.7h16.3q5.25 0 8.1-2.7a8.7 8.7 0 0 0 2.8-6.6 8.7 8.7 0 0 0-2.8-6.6c-1.8-1.9-4.5-2.8-8.1-2.8ZM364.1 42.8a20.674 20.674 0 0 1 1.6-8.2 20.288 20.288 0 0 1 4.3-6.7 19.92 19.92 0 0 1 6.5-4.5 19.718 19.718 0 0 1 8-1.6 18.463 18.463 0 0 1 7.8 1.6 18.677 18.677 0 0 1 6.2 4.5 20.927 20.927 0 0 1 4.1 6.8 23.2 23.2 0 0 1 1.5 8.4v2.3H372a13.822 13.822 0 0 0 4.6 8.4 13.6 13.6 0 0 0 9.1 3.3 15.553 15.553 0 0 0 5.7-1 12.858 12.858 0 0 0 4.6-2.6l5.1 5a25.983 25.983 0 0 1-7.4 4.1 24.69 24.69 0 0 1-8.4 1.3 21.306 21.306 0 0 1-8.4-1.6 22.763 22.763 0 0 1-6.8-4.4 20.788 20.788 0 0 1-4.5-6.7 23.2 23.2 0 0 1-1.5-8.4Zm20.2-14.2a11.527 11.527 0 0 0-8 3 13.046 13.046 0 0 0-4.2 7.8h24.2a13.091 13.091 0 0 0-4.2-7.8 11.106 11.106 0 0 0-7.8-3ZM443.1 63.2v-3.8a19.448 19.448 0 0 1-5.8 3.3 18.924 18.924 0 0 1-6.7 1.2 19.824 19.824 0 0 1-14.6-6.1 22.268 22.268 0 0 1-4.4-6.7 21.812 21.812 0 0 1 0-16.4A20.534 20.534 0 0 1 416 28a19.335 19.335 0 0 1 6.6-4.5 20.334 20.334 0 0 1 8.2-1.6 20.7 20.7 0 0 1 6.6 1 19.415 19.415 0 0 1 5.7 3V7.2l8-1.8v57.8Zm-25.2-20.4a13.718 13.718 0 0 0 4 10.1 13.45 13.45 0 0 0 9.8 4.1 14.956 14.956 0 0 0 6.4-1.3 15.954 15.954 0 0 0 4.9-3.6V33.6a14.988 14.988 0 0 0-4.9-3.5 15.271 15.271 0 0 0-6.4-1.3 13.423 13.423 0 0 0-9.9 4 13.806 13.806 0 0 0-3.9 10ZM478.1 63.2v-56h8.4v24h29.8v-24h8.4v56h-8.4V38.8h-29.8v24.4ZM547.2 64a16.483 16.483 0 0 1-10.8-3.5 11.037 11.037 0 0 1-4.2-8.9 10.375 10.375 0 0 1 4.7-9.2 20.76 20.76 0 0 1 11.8-3.2 27.841 27.841 0 0 1 5.8.6 27.374 27.374 0 0 1 5.3 1.6v-4.3a8.143 8.143 0 0 0-2.6-6.5 11.452 11.452 0 0 0-7.4-2.2 20.788 20.788 0 0 0-6 .9 34.616 34.616 0 0 0-6.6 2.6l-3-6a54.169 54.169 0 0 1 8.4-3.1 33.18 33.18 0 0 1 8.3-1.1c5.2 0 9.3 1.3 12.2 3.8s4.4 6.1 4.4 10.8v27h-7.8v-3.5a19.441 19.441 0 0 1-5.8 3.2 23.54 23.54 0 0 1-6.7 1Zm-7.3-12.6a5.646 5.646 0 0 0 2.6 4.8 11.193 11.193 0 0 0 6.6 1.8 16.256 16.256 0 0 0 5.9-1 14.449 14.449 0 0 0 4.9-2.9V47a19.778 19.778 0 0 0-4.8-1.8 24.933 24.933 0 0 0-5.7-.6 11.859 11.859 0 0 0-6.8 1.8 5.728 5.728 0 0 0-2.7 5ZM580.6 53.2v-24H572v-6.7h8.6V12.1l7.9-1.9v12.3h12v6.7h-12v22.1a5.94 5.94 0 0 0 1.4 4.4c.9.9 2.5 1.3 4.6 1.3a23.637 23.637 0 0 0 3-.2 10.857 10.857 0 0 0 2.8-.8v6.7a19.28 19.28 0 0 1-3.8.9 27.484 27.484 0 0 1-3.8.3c-3.9 0-7-.9-9-2.8-2-1.7-3.1-4.4-3.1-7.9Z"></path></g><path d="M127 90.2c12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4L149.8 37c-1.7-7.1-3.2-10.3-15.7-16.6-9.7-5-30.8-13.1-37.1-13.1-5.8 0-7.5 7.5-14.4 7.5-6.7 0-11.6-5.6-17.9-5.6-6 0-9.9 4.1-12.9 12.5 0 0-8.4 23.7-9.5 27.2a4.216 4.216 0 0 0-.3 1.9c0 9.2 36.3 39.4 85 39.4Zm32.5-11.4c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3C21.8 58.8 0 61.8 0 81c0 31.5 74.6 70.3 133.7 70.3 45.3 0 56.7-20.5 56.7-36.6-.1-12.8-11-27.3-30.9-35.9Z" fill="#e00"></path><path d="M159.5 78.8c1.7 8.2 1.7 9.1 1.7 10.1 0 14-15.7 21.8-36.4 21.8-46.8 0-87.7-27.4-87.7-45.5a17.535 17.535 0 0 1 1.5-7.3l3.7-9.1a4.877 4.877 0 0 0-.3 2c0 9.2 36.3 39.4 85 39.4 12.5 0 30.6-2.6 30.6-17.5a12.678 12.678 0 0 0-.3-3.4Z"></path><path d="M253.5 158.7a2.22 2.22 0 0 1-2.2-2.2V2.2a2.2 2.2 0 0 1 4.4 0v154.2a2.242 2.242 0 0 1-2.2 2.3Z" fill="#111"></path><text data-name="Demo Platform" transform="translate(1186 149)" fill="#111" font-size="82" font-family="'RedHatDisplay', 'Overpass', overpass, helvetica, arial, sans-serif" font-weight="700"><tspan x="-877.892" y="0">Demo Platform</tspan></text></svg></div></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
